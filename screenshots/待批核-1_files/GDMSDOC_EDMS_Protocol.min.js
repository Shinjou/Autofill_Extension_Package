(function(){function t(){try{n.win_EDMS=window.open("","EDMS_Frame",n.sParm);n.win_EDMS.moveTo(0,0);n.win_EDMS.resizeTo(screen.availWidth,screen.availHeight);n.win_EDMS.location="../USER/USER_PRO_EDMS.aspx?sParameter="+sParameter}catch(t){}}var n=window.GDMSDOC_EDMS_Protocol={};n.timeoutId;n.sParm="";n.sParameter="";n.win_EDMS=null;n.odis_ReceiveMessage=function(i){var u,h,f,o,s,r,e;try{if(clearTimeout(n.timeoutId),u=JSON.parse(i.data),u.project&&u.project=="EDMS"&&u.op)switch(u.op){case"open":h=window.top.frames.head;h.document.getElementById("EDMS_Showed").value=u.show;break;case"isUpdated":if(f="",o=!1,u.message.length==0?f="公文製作已開啟，是否開啟新的公文？":(o=!0,f="公文製作已開啟，是否儲存並開啟新公文？"),s=confirm(f),s)r={},o?(r={project:"ODIS",op:"saveDoc"},e=JSON.stringify(r),n.SendCommand(e)):(r={project:"ODIS",op:"openDoc",Token:n.sParameter,open:"2"},e=JSON.stringify(r),n.SendCommand(e),n.timeoutId=setTimeout(t,2e3));else if(window.navigator.userAgent.indexOf("MSIE")!=-1||window.navigator.userAgent.indexOf("Trident")!=-1||window.navigator.userAgent.indexOf("Edge")!=-1||window.navigator.userAgent.indexOf("Edg")!=-1)setTimeout(function(){n.win_EDMS.focus()},1e3);else try{n.win_EDMS=window.open("","EDMS_Frame",n.sParm);n.win_EDMS.moveTo(0,0)}catch(c){}break;case"openDoc":if(window.navigator.userAgent.indexOf("MSIE")!=-1||window.navigator.userAgent.indexOf("Trident")!=-1||window.navigator.userAgent.indexOf("Edge")!=-1||window.navigator.userAgent.indexOf("Edg")!=-1)setTimeout(function(){n.win_EDMS.focus()},1e3);else try{n.win_EDMS=window.open("","EDMS_Frame",n.sParm);n.win_EDMS.moveTo(0,0)}catch(c){}break;case"saveFail":if(alert(u.message),window.navigator.userAgent.indexOf("MSIE")!=-1||window.navigator.userAgent.indexOf("Trident")!=-1||window.navigator.userAgent.indexOf("Edge")!=-1||window.navigator.userAgent.indexOf("Edg")!=-1)setTimeout(function(){n.win_EDMS.focus()},1e3);else try{n.win_EDMS=window.open("","EDMS_Frame",n.sParm);n.win_EDMS.moveTo(0,0)}catch(c){}break;case"saveComplete":n.sParm=="SYS_PRO_AGENT"?(n.win_EDMS.close(),setTimeout(function(){window.top.location=n.sParameter},200)):(r={},r={project:"ODIS",op:"openDoc",Token:n.sParameter,open:"1"},e=JSON.stringify(r),n.SendCommand(e),n.timeoutId=setTimeout(t,2e3));break;case"isOpened":f="";o=!1;u.message.length==0?f="公文製作已開啟，是否關閉？":(o=!0,f="公文製作已開啟，是否儲存並關閉？");s=confirm(f);s&&(r={},o?(r={project:"ODIS",op:"saveDoc"},e=JSON.stringify(r),n.SendCommand(e)):(n.win_EDMS.close(),setTimeout(function(){window.top.location=n.sParameter},200)))}else return}catch(c){}};n.SendCommand=function(t){clearTimeout(n.timeoutId);n.win_EDMS.postMessage(t,"*")};$(document).ready(function(){window.addEventListener?window.addEventListener("message",n.odis_ReceiveMessage,!1):window.attachEvent&&window.attachEvent("onmessage",n.odis_ReceiveMessage)})})();
//# sourceMappingURL=GDMSDOC_EDMS_Protocol.min.js.map
