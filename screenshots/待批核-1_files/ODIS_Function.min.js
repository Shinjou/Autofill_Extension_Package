function FKI_GDOCPK_CHECK_YEAR(n,t){var r,e,i,u,f,o,s;t.IsValid=!0;u=n.controltovalidate;i=document.getElementById(u).value;f=document.getElementById(u).attributes.showName.value;o=u.replace("FKI_txt_GDOC_PK","FKI_txt_YEAR");(i.length==12||i.length==13)&&(document.all[u].value=i.toUpperCase(),i=i.substr(2,10),r=i.match(/[^0-9]/g),r==null?(r=i.substr(0,3),e=document.getElementById(o).value,r!=e&&(n.errormessage=f+"前三碼要等於年度",t.IsValid=!1)):(n.errormessage=f+"輸入錯誤",t.IsValid=!1));i.length==10||i.length==11?(i=i.substr(0,10),r=i.match(/[^0-9]/g),r==null?(r=i.substr(0,3),e=document.getElementById(o).value,r!=e&&(n.errormessage=f+"前三碼要等於年度",t.IsValid=!1)):(n.errormessage=f+"輸入錯誤",t.IsValid=!1)):(s=FKI_GIVE_GDOCPK(u,document.getElementById(o).value),s==!1&&(n.errormessage=f+"輸入錯誤",t.IsValid=!1))}function FKI_GDOCPK_CHECK(n,t){var f,i,r,u,s,e,o;t.IsValid=!0;s="";r=n.controltovalidate;i=document.getElementById(r).value;u=document.getElementById(r).attributes.showName.value;e=r.replace("FKI_txt_GDOC_PK","FKI_txt_YEAR");i.length==10||i.length==11?(i=i.substr(0,10),f=i.match(/[^0-9]/g),f!=null&&(n.errormessage=u+"輸入錯誤",t.IsValid=!1)):(o=FKI_GIVE_GDOCPK(r,document.getElementById(e).value),o==!1&&(n.errormessage=u+"輸入錯誤",t.IsValid=!1))}function FKI_GDOCPK_CHECK_N(n,t){var u,i,r,f,o,e,s;t.IsValid=!0;o="";r=n.controltovalidate;i=document.getElementById(r).value;f=document.getElementById(r).attributes.showName.value;e=r.replace("FKI_txt_GDOC_PK","FKI_txt_YEAR");i.length==10||i.length==11?(i=i.substr(0,10),u=i.match(/[^0-9]/g),u!=null&&(n.errormessage=f+"輸入錯誤",t.IsValid=!1)):s=FKI_GIVE_GDOCPK(r,document.getElementById(e).value)}function FKI_GIVE_GDOCPK(n,t){var r,u,f,e;if(u=RTrim(document.getElementById(n).value),r=u.length,r==0)return!0;if(u=u.replace("　"," "),f=u.split(" "),f.length==1?(sTemp=sGOV_CODE,u=f[0]):(sTemp=f[0].toUpperCase(),u=f[1]),r=u.length,r<8){for(e=t,i=r;i<7;i++)e=e+"0";return document.getElementById(n).value=sTemp+e+u,!0}return r==10||r==11?!0:r==12||r==13?!0:!1}function FKI_GIVE_CTRLPK(n,t){var r,f,u;if(f=document.getElementById(n).value,r=f.length,r==0)return!0;if(r<7){for(u=t,i=r;i<6;i++)u=u+"0";return document.getElementById(n).value=u+f,!0}return r==9?!0:!1}function FKI_ReturnParent(n){window.top.frames.main.location=n}function WinDataRefresh(){Form1.all.argbCache.value="True";Form1.submit()}function checkForm(n,t){try{window.top.opener.closed==!1?t.IsValid=!0:(t.IsValid=!1,n.errormessage="主視窗已經關閉，請重新登入")}catch(i){}}function ReturnForm(){var r,i,t,n;r=window.location.pathname;i=r.split("/");t=i[i.length-1];t=t.toUpperCase();switch(t){case"RCV_PRO_DELETE.ASPX":n="";break;case"RCV_PRO_OUT_SUPPSIGN.ASPX":n="簽收成功";break;case"RCV_PRO_NEXT.ASPX":case"UNIT_PRO_NEXT.ASPX":case"UNIT_PRO_NEXTSUP.ASPX":n="";break;case"RCV_PRO_CANCEL.ASPX":case"USER_PRO_CANCEL.ASPX":n="";break;case"RCV_PRO_GDOC_EDIT.ASPX":case"USER_PRO_ATTACH_EDIT.ASPX":n="";break;case"UNIT_PRO_MOVE.ASPX":n="";break;case"RCV_PRO_REJECT.ASPX":case"UNIT_PRO_REJECT.ASPX":case"USER_PRO_REJECT.ASPX":n="";break;case"UNIT_PRO_REJECTSUP.ASPX":n="退會設定成功";break;case"USER_PRO_CLOSE.ASPX":n="";break;case"USER_PRO_SEND.ASPX":n="";break;case"USER_PRO_SUPPORT.ASPX":n="會辦設定成功";break;case"USER_PRO_UPJUDGE.ASPX":n="";break;case"USER_PRO_EXTEND.ASPX":n="";break;case"USER_PRO_MERGE.ASPX":n="併案(彙辦)設定成功";break;case"CONFIRM_PRO_REJECT.ASPX":case"SEND_PRO_REJECT.ASPX":case"FILE_PRO_REJECT.ASPX":n="";break;case"USER_PRO_SUPPORTDONE.ASPX":n="";break;case"UNIT_PRO_GDOCSUBT_EDIT.ASPX":n="會勘/補正設定成功";break;case"UNIT_PRO_ATTACH_REPLY.ASPX":n="函復資訊儲存成功";break;default:n=""}n!=""&&FLAlert(n);CloseWin()}function CloseWin(n){var t;if(window.top.opener==undefined){n==undefined&&(n=!0);window.parent.CloseModal(n);return}if(typeof window.top.modalPopupWindow!="undefined"){callbackFunction("");return}if(navigator.userAgent.indexOf("Mac")>-1)if(window.top.opener){if(t=window.top.opener,typeof t=="object")try{t.WinDataRefresh()}catch(i){}finally{window.top.close()}else window.top.close();window.top.close()}else window.top.close();else if(window.top.opener.closed)window.top.close();else{if(t=window.top.opener,typeof t=="object")try{t.WinDataRefresh()}catch(i){}finally{window.top.close()}else window.top.close();window.top.close()}}function Action_CallUrl(n,t){var r=igmenu_getItemById(t),i=r.getTag(),u=i.split("|")[0],f=i.split("|")[1];Call_Frm(u,f)}function Call_Frm(n,t){var i,r;i=t+"?sGDOC_PK="+Form1.argGDOC_PK.value+"&sSSTA_FK="+Form1.argSSTA_FK.value+"&sReturnType="+Form1.argReturnType.value+"&sGOV_FK="+Form1.argGOV_FK.value;switch(n){case"WAE1020":i=i+"&sROLE_FK="+Form1.argROLE_FK.value;window.parent.PopupWindow(860,600,i);break;case"WAE1040":i=i+"&sROLE_FK="+Form1.argROLE_FK.value;window.parent.PopupWindow(860,600,i);break;case"WAE1050":r="確定刪除該電子文資訊";FLConfirm(r,"","1")=="OK"&&GDMS_Dlg_OpenWindow(350,150,i+"&sRCV_PK="+Form1.argRCV_PK.value);break;case"WAE1070":i=i+"&sROLE_FK="+Form1.argROLE_FK.value;window.parent.PopupWindow(860,500,i);break;case"WAE2030":case"WAEU030":i=i+"&sROLE_FK="+Form1.argROLE_FK.value+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value;window.parent.PopupWindow(860,500,i);break;case"WAE2010":case"WAE2040":case"WAE2050":case"WAE2070":case"WAEU010":case"WAEU040":case"WAEU050":i=i+"&sROLE_FK="+Form1.argROLE_FK.value+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value;window.parent.PopupWindow(860,600,i);break;case"WAE1030":case"WAE2020":case"WAE3010":case"WAE3011":case"WAE3012":case"WAE3070":case"WAEU020":case"WAEU060":case"WAEU070":i=i+"&sROLE_FK="+Form1.argROLE_FK.value+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value;window.parent.PopupWindow(860,520,i);break;case"WAE2060":case"WAE3080":i=i+"&sROLE_FK="+Form1.argROLE_FK.value+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value;window.parent.PopupWindow(860,500,i);break;case"WAE2080":i=i+"&sROLE_FK="+Form1.argROLE_FK.value+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value;window.parent.PopupWindow(860,500,i);break;case"WAE3090":i=i+"&sROLE_FK="+Form1.argROLE_FK.value+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value;window.parent.PopupWindow(860,500,i);break;case"WAE6010":case"WAE2090":i=i+"&sROLE_FK="+Form1.argROLE_FK.value;window.parent.PopupWindow(860,520,i);break;case"WAE4010":i=i+"&sROLE_FK="+Form1.argROLE_FK.value;window.parent.PopupWindow(860,510,i);break;case"WAE4020":i=i+"&sROLE_FK="+Form1.argROLE_FK.value+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value;window.parent.PopupWindow(860,520,i);break;case"WAE4030":case"WAE4040":case"WAE4050":case"WAE3030":i=i+"&sROLE_FK="+Form1.argROLE_FK.value;window.parent.PopupWindow(860,510,i);break;case"WAE3020":case"WAE3021":i=i+"&sROLE_FK="+Form1.argROLE_FK.value+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value;window.parent.PopupWindow(860,600,i);break;case"SUPINFO":i=t+"?sGDOC_PK="+Form1.argGDOC_PK.value+"&sSSTA_FK="+Form1.argSSTA_FK.value+"&sROLE_FK="+Form1.argROLE_FK.value+"&sReturnType="+Form1.argReturnType.value+"&sGOV_FK="+Form1.argGOV_FK.value;window.parent.PopupWindow(860,580,i);break;case"WAE3040":case"WAE6020":case"WAE20A0":i="../LIB/LIB_FRAMESET.aspx?sURL="+t+"&sGDOC_PK="+Form1.argGDOC_PK.value+"&sSSTA_FK="+Form1.argSSTA_FK.value+"&sROLE_FK="+Form1.argROLE_FK.value+"&sReturnType="+Form1.argReturnType.value+"&sGOV_FK="+Form1.argGOV_FK.value;try{window.parent.PopupWindow(860,620,i)}catch(u){window.parent.parent.PopupWindow(860,620,i)}break;case"WAE6022":i=i+"&sROLE_FK="+Form1.argROLE_FK.value;try{window.parent.PopupWindow(860,620,i)}catch(u){window.parent.parent.PopupWindow(860,620,i)}break;case"WAE6030":case"WAE6040":i=i+"&sROLE_FK="+Form1.argROLE_FK.value;window.parent.PopupWindow(350,150,i);break;case"CLOSE1":i="../LIB/LIB_FRAMESET.aspx?sURL="+t+"&sGDOC_PK="+Form1.argGDOC_PK.value+"&sSSTA_FK="+Form1.argSSTA_FK.value+"&sROLE_FK="+Form1.argROLE_FK.value+"&sReturnType="+Form1.argReturnType.value+"&sGOV_FK="+Form1.argGOV_FK.value;window.parent.PopupWindow(860,600,i);break;case"WAE3050":case"WAE3140":i="../LIB/LIB_FRAMESET.aspx?sURL="+t+"&sGDOC_PK="+Form1.argGDOC_PK.value+"&sSSTA_FK="+Form1.argSSTA_FK.value+"&sROLE_FK="+Form1.argROLE_FK.value+"&sReturnType="+Form1.argReturnType.value+"&sGOV_FK="+Form1.argGOV_FK.value;try{window.parent.PopupWindow(860,600,i)}catch(u){window.parent.parent.PopupWindow(860,600,i)}break;case"WAE3060":i=t+"?sGDOC_PK="+Form1.argGDOC_PK.value+"&sSSTA_FK="+Form1.argSSTA_FK.value+"&sROLE_FK="+Form1.argROLE_FK.value+"&sReturnType="+Form1.argReturnType.value+"&sGOV_FK="+Form1.argGOV_FK.value;window.parent.PopupWindow(860,660,i);break;case"EXTEND":i=t+"?sGDOC_PK="+Form1.argGDOC_PK.value+"&sSSTA_FK="+Form1.argSSTA_FK.value+"&sROLE_FK="+Form1.argROLE_FK.value+"&sReturnType="+Form1.argReturnType.value+"&sGOV_FK="+Form1.argGOV_FK.value;window.parent.PopupWindow(860,620,i);break;case"REPLY":i="../LIB/LIB_FRAMESET.aspx?sURL="+t+"&sGDOC_PK="+Form1.argGDOC_PK.value+"&sSSTA_FK="+Form1.argSSTA_FK.value+"&sROLE_FK="+Form1.argROLE_FK.value+"&sReturnType="+Form1.argReturnType.value+"&sGOV_FK="+Form1.argGOV_FK.value;window.parent.PopupWindow(860,520,i);break;case"CONTENT":Form1.argUNIT_FK_CUR==undefined?GDMS_Dlg_OpenWindow(860,600,"../LIB/LIB_FRAMESET.aspx?sURL="+t+"&sGDOC_PK="+Form1.argGDOC_PK.value+"&sSSTA_FK="+Form1.argSSTA_FK.value+"&sReturnType="+Form1.argReturnType.value+"&sGOV_FK="+Form1.argGOV_FK.value):Form1.argSSTA_FK.value=="WAT3020"?(i="../LIB/LIB_FRAMESET.aspx?sURL="+t+"&sGDOC_PK="+Form1.argGDOC_PK.value+"&sSSTA_FK="+Form1.argSSTA_FK.value+"&sROLE_FK="+Form1.argROLE_FK.value+"&sReturnType="+Form1.argReturnType.value+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value+"&sGOV_FK="+Form1.argGOV_FK.value,window.parent.PopupWindow(860,660,i)):(i="../LIB/LIB_FRAMESET.aspx?sURL="+t+"&sGDOC_PK="+Form1.argGDOC_PK.value+"&sSSTA_FK="+Form1.argSSTA_FK.value+"&sROLE_FK="+Form1.argROLE_FK.value+"&sReturnType="+Form1.argReturnType.value+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value+"&sGOV_FK="+Form1.argGOV_FK.value,window.parent.PopupWindow(860,660,i));break;case"SENDDOC":Form1.argGDOC_FILEID.value==""?FLAlert("無『公文製作』檔案!!",""):Form1.argEDMS_Parameter.value==""?setTimeout(function(){OpenSend(Form1.argGDOC_PK.value,Form1.argGDOC_FILEID.value,Form1.argROLE_FK.value,0)},500):setTimeout(function(){EDMS_Open_File(Form1.argEDMS_Parameter.value)},500);break;case"SEND010":Form1.argGDOC_FILEID.value==""?FLAlert("無『公文製作』檔案!!",""):Form1.argEDMS_Parameter.value==""?setTimeout(function(){OpenSend(Form1.argGDOC_PK.value,Form1.argGDOC_FILEID.value,Form1.argROLE_FK.value,1)},500):setTimeout(function(){EDMS_Open_File(Form1.argEDMS_Parameter.value)},500);break;case"SIGN":window.top.frames.process.location=Form1.argUNIT_FK_CUR==undefined?"../LIB/GDMS_PROCESS.aspx?Job=SetSIGN&sGDOC_PK="+Form1.argGDOC_PK.value+"&sROLE_FK="+Form1.argROLE_FK.value+"&sGOV_FK="+Form1.argGOV_FK.value:"../LIB/GDMS_PROCESS.aspx?Job=SetSIGN&sGDOC_PK="+Form1.argGDOC_PK.value+"&sROLE_FK="+Form1.argROLE_FK.value+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value+"&sUNIT_FK_FROM="+Form1.argUNIT_FK_FROM.value+"&sGOV_FK="+Form1.argGOV_FK.value;break;case"PROC":case"PSIGN":i=i+"&sROLE_FK="+Form1.argROLE_FK.value;window.parent.PopupWindow(860,520,i);break;case"PLAN":i=t+"?sGDOC_PK="+Form1.argGDOC_PK.value+"&sUNIT_PK="+Form1.argUNIT_FK_CUR.value+"&sSSTA_FK="+Form1.argSSTA_FK.value+"&sROLE_FK="+Form1.argROLE_FK.value+"&sReturnType="+Form1.argReturnType.value+"&sGOV_FK="+Form1.argGOV_FK.value;window.parent.PopupWindow(860,600,i);break;case"WAE5010":case"WAE5020":i=i+"&sROLE_FK="+Form1.argROLE_FK.value+"&sCTRL_PK="+Form1.argCTRL_PK.value;window.parent.PopupWindow(860,620,i);break;case"CTRL":case"WAE5030":case"WAE5040":case"WAE5060":i="../CTRL/CTRL_FRAMESET.aspx?sURL="+t+"&sCTRL_PK="+Form1.argGDOC_PK.value+"&sReturnType="+Form1.argReturnType.value+"&sGOV_FK="+Form1.argGOV_FK.value;window.parent.PopupWindow(860,660,i);break;case"COMMENT":i=i+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value+"&sROLE_FK="+Form1.argROLE_FK.value;window.parent.PopupWindow(860,470,i);break;case"WAE3210":case"WAE3220":case"WAE3230":i=i+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value+"&sROLE_FK="+Form1.argROLE_FK.value;window.parent.PopupWindow(860,520,i);break;case"DOCINFO":i="../LIB/LIB_FRAMESET.aspx?sURL="+t+"&sGDOC_PK="+Form1.argGDOC_PK.value+"&sSSTA_FK="+Form1.argSSTA_FK.value+"&sROLE_FK="+Form1.argROLE_FK.value+"&sReturnType="+Form1.argReturnType.value+"&sGOV_FK="+Form1.argGOV_FK.value+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value;window.parent.PopupWindow(860,600,i);break;case"WBE3010":case"WBE3030":i=i+"&sROLE_FK="+Form1.argROLE_FK.value;window.parent.PopupWindow(860,470,i);break;case"WBE3020":i=i+"&sROLE_FK="+Form1.argROLE_FK.value;window.parent.PopupWindow(860,550,i);break;case"NEXT":i=i+"&sROLE_FK="+Form1.argROLE_FK.value+"&sUNIT_FK_CUR="+Form1.argUNIT_FK_CUR.value;window.parent.PopupWindow(860,600,i);break;default:GDMS_Dlg_OpenWindow(860,600,i)}}function printBARCODE(n){var u,f,t,i;u=(screen.height-100)/2;f=(screen.width-300)/2;var o="top="+u+",left="+f+",width=300px,height=100px,scrollbars=yes,resizable=yes",r=n.split(";"),e=window.navigator.userAgent;if(e.indexOf("MSIE")!=-1||e.indexOf("Trident")!=-1)for(t=0;t<r.length;t+=1)r[t]>""&&(i="../LIB/BARCODE_PRINT.aspx?cCODE="+encodeURIComponent(r[t]),window.open(i,t,o));else i="fkiBarCodeProtocol://?"+n+";;1.0.0.0|TAI",GDMS_Dlg_OpenWindow(500,200,i)}function _print(){console.log((new Date).getTime())}function GDOC_AttUnit(n,t){var i;switch(RTrim(n.value)){case"1":i="頁";break;case"2":case"8":case"9":case"D":i="捲";break;case"3":case"4":case"5":case"6":case"7":case"A":case"B":case"C":i="張";break;case"E":i="幅";break;default:i=""}document.getElementById(t).value=i}function Open_ItemClick_Action(n,t){var u=igmenu_getItemById(t),r=u.getTag(),f=r.split("|")[0],i=r.split("|")[1];switch(f){case"SEND010":var e=r.split("|")[1],o=r.split("|")[2],s=r.split("|")[3];setTimeout(function(){OpenSend(e,o,"100",s)},500);break;case"WAE1020":window.parent.PopupWindow(860,650,i);break;case"WAE1030":window.parent.PopupWindow(860,450,i);break;case"WAE1040":window.parent.PopupWindow(860,460,i);break;case"WAE1050":return FLConfirm("確定刪除嗎？","訊息視窗","1")!="OK";case"WAE2010":case"WAE2050":case"WAEU010":case"WAEU040":case"WAEU050":window.parent.PopupWindow(860,520,i);break;case"WAE2020":case"WAEU020":window.parent.PopupWindow(860,520,i);break;case"WAE1070":case"WAE1071":case"WAE2060":case"WAE2080":case"WAE2081":window.parent.PopupWindow(860,520,i);break;case"WAE6020":window.parent.PopupWindow(860,600,i)}return!1}function FKI_OpenViewer(n,t,i,r){var u=window.open("","","toolbar=no,scrollbar=no,location=no,menubar=no,status=no,resizable=yes");u.location="../FKI_Viewer/FKI_Viewer_Main.aspx?cGOV_FK="+n+"&cGDOC_FK="+t+"&iWRITE_FK="+i+"&iDOC_TYPE="+r}function getBroswer(){var n={},i=navigator.userAgent.toLowerCase(),t;return((t=i.match(/edge\/([\d.]+)/))?n.edge=t[1]:(t=i.match(/rv:([\d.]+)\) like gecko/))?n.ie=t[1]:(t=i.match(/msie ([\d.]+)/))?n.ie=t[1]:(t=i.match(/firefox\/([\d.]+)/))?n.firefox=t[1]:(t=i.match(/chrome\/([\d.]+)/))?n.chrome=t[1]:(t=i.match(/opera.([\d.]+)/))?n.opera=t[1]:(t=i.match(/version\/([\d.]+).*safari/))?n.safari=t[1]:0,n.edge)?{broswer:"Edge",version:n.edge}:n.ie?{broswer:"IE",version:n.ie}:n.firefox?{broswer:"Firefox",version:n.firefox}:n.chrome?{broswer:"Chrome",version:n.chrome}:n.opera?{broswer:"Opera",version:n.opera}:n.safari?{broswer:"Safari",version:n.safari}:{broswer:"",version:"0"}}try{divLoad.style.display="none";Form1.style.display=""}catch(e){}var sGOV_CODE="";document.all.spanGOV_CODE!=undefined&&(sGOV_CODE=spanGOV_CODE.innerHTML);
//# sourceMappingURL=ODIS_Function.min.js.map
