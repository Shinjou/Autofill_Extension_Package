function portInfo(n,t,i,r,u){var f,e;arguments.length!=0&&(f=imgEnum.info,typeof t=="string"&&(f=t.toLowerCase()=="warn"?imgEnum.warn:imgEnum.info),e=posMode.center,typeof i=="string"&&(e=i.toLowerCase()=="sel"?posMode.sel:i.toLowerCase()=="mouse"?posMode.mouse:posMode.center),setPanelMsg(n,f,e,r,u))}function centerPanelMsg(n,t){if(arguments.length!=0){var i=imgEnum.info;typeof t=="string"&&(i=t.toLowerCase()=="warn"?imgEnum.warn:imgEnum.info);setPanelMsg(n,i,posMode.center,wantCloseWin.no)}}function selPanelMsg(n,t,i,r){if(arguments.length==4){var u=imgEnum.info;typeof t=="string"&&(u=t.toLowerCase()=="warn"?imgEnum.warn:imgEnum.info);setPanelMsg(n,u,i,r,posMode.sel,wantCloseWin.no)}}function mousePanelMsg(n,t){if(arguments.length!=0){var i=imgEnum.info;typeof t=="string"&&(i=t.toLowerCase()=="warn"?imgEnum.warn:imgEnum.info);setPanelMsg(n,i,posMode.mouse,wantCloseWin.no)}}function PanelMsgInit(n,t){var r=!1,i;(n==undefined&&(n=210),n<210&&(n=210),t==undefined?t=32:r=!0,i="#message",i+="\n{",i+="\n     color: #262626;",i+="\n     background-color:#FFFF66;",i+="\n     border-width: 1px;",i+="\n     border-color: #FF0D0D;",i+="\n     border-style: solid;",i+="\n     width:"+n+"px;",r?(i+="\n     height:"+t+"px;",i+="\n     min-height:"+t+"px;",i+="\n     overflow-y:auto;"):(i+="\n     height: auto;",i+="\n     min-height: 24px;"),i+="\n     line-height: 140%;",i+="\n     font-size: 11pt;",i+="\n     font-family: 新細明體, Courier New;",i+="\n     padding: 1px;",i+="\n     display: none;",i+="\n     position: absolute;",i+="\n     z-index:20000;",i+="\n}",oStyle=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(oStyle),document.all?oStyle.styleSheet.cssText=i:oStyle.textContent=i,document.getElementById("message"))||(i="",i+="\n    <div id='message'>",i+="\n    <table style='background-color: #FFFF66; width: 100%;' cellpadding='3' cellspacing='2'>",i+="\n        <tr>",i+="\n        \t<td valign='middle' align='left' width='100%'>",i+="\n                 <table style='width: 100%; border:0px' align='left' cellspacing='0' cellpadding='0'>",i+="\n                       <tr style='width: 100%; height: 100%; background: #FFFF66'>",i+="\n                       <td valign='middle' align='center' width='32px'><img id='Msg_img' src='../ig_res/Information24.png' alt='' title='訊息'/><\/td>",i+="\n                           <td style='width:*; height: 99%;'>",i+="\n                               <span id='postMsg'>這是訊息一<br>這是訊息一",i+="\n                               <\/span>",i+="\n                           <\/td>",i+="\n                       <\/tr>",i+="\n                 <\/table>",i+="\n            <\/td>",i+="\n        <\/tr>",i+="\n   <\/table>",i+="\n   <input id='MouseX' type='hidden' value='0' />",i+="\n   <input id='MouseY' type='hidden' value='0' />",isIE()||(i+="\n   <input id='focusText' type='text' style='width:0px; height:0px;border:none 0px #FFFF66; background-color:#FFFF66; readonly:readonly;' />"),i+="\n   <\/div>",i+="\n   <script type='text/javascript'>",i+="\n   var orginalMessage=document.getElementById('message').cloneNode(true);",i+="\n   function restoreMessage(){",i+="\n      if(document.orginalMessage){",i+="\n           if(document.body.getElementsByTagName('form')[0]){",i+="\n              var inform =document.body.getElementsByTagName('form')[0];",i+="\n              inform.replaceChild(document.orginalMessage, document.getElementById('message'));",i+="\n           }else {",i+="\n              document.body.replaceChild(document.orginalMessage, document.getElementById('message'));",i+="\n           }",i+="\n      }",i+="\n   }",i+="\n   <\/script>",document.write(i))}function getMouseXY(n){var n=n||window.event,t={x:0,y:0},s,i,u,r,f,h,o;for((n.clientX||n.clientY)&&document.body&&document.body.scrollLeft!=null&&(t.x=n.clientX+document.body.scrollLeft,t.y=n.clientY+document.body.scrollTop),(n.clientX||n.clientY)&&document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.scrollLeft!=null&&(t.x=n.clientX+document.documentElement.scrollLeft,t.y=n.clientY+document.documentElement.scrollTop),(n.pageX||n.pageY)&&(t.x=n.pageX,t.y=n.pageY),s=n.target||n.srcElement,i=s;i.parentNode;)i=i.parentNode;for(u=parent.frames,r=0;r<u.length;r++)if(f=u[r].name,f){var e=parent.document.getElementsByName(f),c=e[0].id,l=e[0].contentDocument||e[0].contentWindow.document;if(i==l){h=parent.document.getElementById(c);o=h.getBoundingClientRect();t.x+=o.left;t.y+=o.top;break}}if(t.x<0&&(t.x=0),t.y<0&&(t.y=0),params.message=document.getElementById("message"),params.message==null){if(self==top)return;autoSearchMessage()}else params.targetPage=this;params.message!=null&&(params.targetPage.document.getElementById("MouseX").value=t.x,params.targetPage.document.getElementById("MouseY").value=t.y)}function setPanelMsgResize(n,t){var i=!1;if(n==undefined&&(n=210),n<210&&(n=210),t==undefined?t=32:i=!0,params.message=document.getElementById("message"),params.message==null){if(self==top)return;autoSearchMessage()}else params.targetPage=this;params.message!=null&&(i?(params.message.style.width=n.toString()+"px",params.message.style.height=t.toString()+"px",params.message.style.minHeight=t.toString()+"px",params.message.style.overflowY="auto"):(params.message.style.width=n.toString()+"px",params.message.style.height="auto",params.message.style.minHeight="24px",params.message.style.overflowY=""),params.targetPage.orginalMessage&&(params.targetPage.document.orginalMessage=params.message.cloneNode(!0)))}function getparentiFrame(n){return n!=parent.location?parent:n}function panelMsgStyle(n,t){return window.getComputedStyle?window.getComputedStyle(n,null)[t]:n.currentStyle?n.currentStyle[t]:null}function panelMsgShow(){if(params.message.style.display=params.message.previousDisplay||"",panelMsgStyle(params.message,"display")==="none"){var n=params.targetPage.document.createElement(params.message.nodeName);params.targetPage.document.body.appendChild(n);params.message.style.display=panelMsgStyle(n,"display");params.targetPage.document.body.removeChild(n)}}function panelMsgHide(){params.message.previousDisplay=panelMsgStyle(params.message,"display");params.message.style.display="none"}function autoSearchMessage(n,t,r,u,f,e,o){var s=function(){var n;for(i=0;i<=20;i++)for(j=0;j<20;j++)navigator.appVersion.match("MSIE "+i+"."+j)!=null&&(n=i+"."+j);if(n=="7.0")navigator.appVersion.match("Trident/4.0")&&(n="8.0"),navigator.appVersion.match("Trident/5.0")&&(n="9.0"),navigator.appVersion.match("Trident/6.0")&&(n="10.0"),navigator.appVersion.match("Trident/7.0")&&(n="11.0");else if(navigator.userAgent.match(/Trident\/7.0;/)&&navigator.userAgent.match(/rv/))for(i=11;i<=20;i++)for(j=0;j<20;j++)(navigator.userAgent.match("rv:"+i+"."+j)!=null||navigator.userAgent.match("rv "+i+"."+j)!=null)&&(n=i+"."+j);return parseFloat(n)};for(chi=location;chi!=getparentiFrame(chi);)if(par=getparentiFrame(chi),params.message=par.document.getElementById("message"),params.message!=null){params.targetPage=par;break}else chi=par;typeof n!="undefined"&&(navigator.userAgent.match("MSIE")&&this.ieVersion<=8?params.message==null&&window.opener&&opener.closed==!1&&typeof opener.setPanelMsg=="object"&&(arguments.length==7?opener.setPanelMsg(n,t,r,u,f,e,o):opener.setPanelMsg(n,t,r,u,f,e)):params.message==null&&window.opener&&!window.opener.closed&&typeof window.opener.setPanelMsg=="function"&&(arguments.length==7?window.opener.setPanelMsg(n,t,r,u,f,e,o):window.opener.setPanelMsg(n,t,r,u,f,e)))}function setPanelMsg(){var n,h,s,c;if(arguments.length!=0&&typeof arguments[0]=="string"){var o=arguments[0],v=function(){return window.outerHeight!=undefined?window.outerHeight:Math.max(document.body.clientHeight,document.documentElement.clientHeight)},l=function(n){var i=!1,t;if(typeof n=="object")for(t in posMode)if(n.name==posMode[t].name&&n.value==posMode[t].value){i=!0;break}return i},a=function(n){var i=!1,t;if(typeof n=="object")for(t in wantCloseWin)if(n.name==wantCloseWin[t].name&&n.value==wantCloseWin[t].value){i=!0;break}return i},u=null,t=null,f=null,i=null,r=null,e=null;for(n=1;n<arguments.length;n++)u==null&&isIMG(arguments[n])?u=arguments[n]:t==null&&l(arguments[n])?t=arguments[n]:r==null&&a(arguments[n])?r=arguments[n]:e==null&&isReload(arguments[n])?e=arguments[n]:typeof arguments[n]=="number"&&i==null?i=arguments[n]:typeof arguments[n]=="number"&&i!=null&&f==null&&(f=arguments[n]);if(u==null&&(u=imgEnum.info),t==null&&f!=null&&i!=null?t=posMode.sel:t==null&&(t=posMode.center),t!=posMode.sel||f!=null&&i!=null){if(r==null&&(r=wantCloseWin.no),r!=null&&e==null&&(e=reloadCloseWin.yes),params.message=document.getElementById("message"),params.message==null)if(self!=top||window.opener)e==null?autoSearchMessage(o,u,t,f,i,r):autoSearchMessage(o,u,t,f,i,r,e);else return;else params.targetPage=this;if(params.message!=null){if(o.length==0){panelMsgHide();return}if(params.targetPage.restoreMessage)if(params.targetPage.restoreMessage(),params.message=document.getElementById("message"),params.message==null)if(self!=top||window.opener)e==null?autoSearchMessage(o,u,t,f,i,r):autoSearchMessage(o,u,t,f,i,r,e);else return;else params.targetPage=this;h=params.targetPage.document.getElementById("postMsg");h.innerHTML=o;s=params.targetPage.document.getElementById("Msg_img");switch(u){case imgEnum.warn:s.setAttribute("src","../ig_res/Exclamation24.png");s.setAttribute("title","警告");break;case imgEnum.info:default:s.setAttribute("src","../ig_res/Information24.png");s.setAttribute("title","訊息")}if(panelMsgStyle(params.message,"display")==="none"){panelMsgShow();isIE()||params.targetPage.document.getElementById("focusText").focus();position.panelWidth=parseInt(panelMsgStyle(params.message,"width").replace("px",""));position.panelHeight=panelMsgStyle(params.message,"height")=="auto"?params.message.clientHeight?params.message.clientHeight:params.message.offsetHeight:parseInt(panelMsgStyle(params.message,"height").replace("px",""));typeof params.targetPage.document.documentElement!="undefined"&&typeof params.targetPage.document.documentElement.clientWidth!="undefined"&&params.targetPage.document.documentElement.clientWidth!=0?(position.documentWidth=params.targetPage.document.documentElement.clientWidth,position.documentHeight=params.targetPage.document.documentElement.clientHeight):typeof innerWidth!="undefined"?(position.documentWidth=window.innerWidth,position.documentHeight=window.innerHeight):(position.documentWidth=params.targetPage.document.getElementsByTagName("body")[0].clientWidth+20,position.documentHeight=params.targetPage.document.getElementsByTagName("body")[0].clientHeight);switch(t){case posMode.sel:params.message.style.left=i.toString()+"px";params.message.style.top=f.toString()+"px";break;case posMode.mouse:position.mouseX=parseInt(params.targetPage.document.getElementById("MouseX").value);position.mouseY=parseInt(params.targetPage.document.getElementById("MouseY").value);params.message.style.left=(position.mouseX-position.panelWidth).toString()+"px";params.message.style.top=(position.mouseY-position.panelHeight).toString()+"px";break;case posMode.center:default:c=0;params.message.style.left=Math.floor((position.documentWidth-position.panelWidth)/2).toString()+"px";params.message.style.top=Math.floor((position.documentHeight-position.panelHeight)/2-c).toString()+"px"}r==wantCloseWin.yes&&CloseModal(e.value);clearEvents()}}}}}function resetPanelMsgHide(){if(params.message=document.getElementById("message"),params.message==null){if(self==top)return;autoSearchMessage()}else params.targetPage=this;params.message!=null&&panelMsgStyle(params.message,"display")=="block"&&clearEvents()}function clearEvents(){params.targetPage.document.onmousedown=function(){panelMsgHide();params.targetPage.document.onmousedown=function(){};params.targetPage.document.onkeydown=function(){};elem=params.targetPage.document.getElementsByTagName("iframe");for(var n=0;n<elem.length;n++)elem[n].contentWindow.document.onmousedown=function(){},elem[n].contentWindow.document.onkeydown=function(){}};params.targetPage.document.onkeydown=function(){panelMsgHide();params.targetPage.document.onmousedown=function(){};params.targetPage.document.onkeydown=function(){};elem=params.targetPage.document.getElementsByTagName("iframe");for(var n=0;n<elem.length;n++)elem[n].contentWindow.document.onmousedown=function(){},elem[n].contentWindow.document.onkeydown=function(){}};elem=params.targetPage.document.getElementsByTagName("iframe");for(var n=0;n<elem.length;n++)elem[n].contentWindow.document.onmousedown=function(){panelMsgHide();params.targetPage.document.onmousedown=function(){};params.targetPage.document.onkeydown=function(){};elem=params.targetPage.document.getElementsByTagName("iframe");for(var n=0;n<elem.length;n++)elem[n].contentWindow.document.onmousedown=function(){},elem[n].contentWindow.document.onkeydown=function(){}},elem[n].contentWindow.document.onkeydown=function(){panelMsgHide();params.targetPage.document.onmousedown=function(){};params.targetPage.document.onkeydown=function(){};elem=params.targetPage.document.getElementsByTagName("iframe");for(var n=0;n<elem.length;n++)elem[n].contentWindow.document.onmousedown=function(){},elem[n].contentWindow.document.onkeydown=function(){}}}var curryingCloseWin,isIE,isIMG,isReload;imgEnum={info:{value:0,name:"Information"},warn:{value:1,name:"Warning"}};posMode={sel:{value:0,name:"Select"},center:{value:1,name:"Center"},mouse:{value:2,name:"Mouse"}};wantCloseWin={no:{value:!1,name:"noCloseWin"},yes:{value:!0,name:"CloseWin"}};reloadCloseWin={no:{value:!1,name:"unReload"},yes:{value:!0,name:"Reload"}};params={message:null,targetPage:null};position={mouseX:null,mouseY:null,panelX:null,panelY:null,panelWidth:null,panelHeight:null,posMode:null,documentWidth:null,documentHeight:null};curryingCloseWin=function(){var n;fn=arguments[0];var i=Array.prototype.slice,t=i.call(arguments,1),r=reloadCloseWin.yes;for(n=0;n<t.length;n++)if(isReload(t[n])){r=t[n];t.splice(n,1);break}return function(){var n=i.call(arguments),u=n.concat(t);fn.apply(null,u);CloseModal(r.value)}};PanelMsgInit.prototype.parentiFrame=getparentiFrame;PanelMsgInit.prototype.Style=panelMsgStyle;PanelMsgInit.prototype.Show=panelMsgShow;PanelMsgInit.prototype.Hide=panelMsgHide;PanelMsgInit.prototype.Search=autoSearchMessage;PanelMsgInit.prototype.Message=setPanelMsg;PanelMsgInit.prototype.ResetHide=resetPanelMsgHide;PanelMsgInit.prototype.MouseXY=getMouseXY;PanelMsgInit.prototype.Resize=setPanelMsgResize;isIE=function(){return navigator.userAgent.match("MSIE")?!0:navigator.userAgent.match(/Trident\/7.0;/)&&navigator.userAgent.match(/rv/)?!0:!1};isIMG=function(n){var i=!1,t;if(typeof n=="object")for(t in imgEnum)if(n.name==imgEnum[t].name&&n.value==imgEnum[t].value){i=!0;break}return i};isReload=function(n){var i=!1,t;if(typeof n=="object")for(t in reloadCloseWin)if(n.name==reloadCloseWin[t].name&&n.value==reloadCloseWin[t].value){i=!0;break}return i};
//# sourceMappingURL=ODIS_Message.min.js.map
